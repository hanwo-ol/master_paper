---
title: "석사 학위 논문 연구 계획서 - Bayesian+AnomalyDetection"
date: 2025-11-13       
description: "졸업 논문 주제 구체화 - Bayesian+AnomalyDetection"
categories: [Bayesian, AnomalyDetection, Idea, MoE, VAE]
author: "김한울"
---


# 연구 기획서 (초안)

## 1. 연구 주제 (가제)

**다변량 딥러닝 기반 이상치 탐지에서의 불확실성 추정과  
Mixture-of-VAEs를 활용한 위험 민감 의사결정 프레임워크**

(영문 예시)  
**Risk-Aware Decision Framework with Uncertainty-Aware Deep Multivariate Anomaly Detection using Variational and Mixture-of-VAEs**

---

## 2. 연구 배경 및 필요성

제조 공정, 네트워크 트래픽, 금융 거래, 의료 모니터링 등 다양한 응용 분야에서
다변량(multivariate) 시계열·표형 데이터에 대한 **이상치 탐지(anomaly / outlier detection) **는
안전성, 비용 절감, 서비스 안정성 측면에서 매우 중요한 과제이다.

그러나 기존 딥러닝 기반 이상치 탐지 기법들(예: Autoencoder, LSTM-AE, CNN 기반 모델 등)은 다음과 같은 한계를 가진다.

1. **이상치 점수만 제공**  
   - 단일 스칼라 점수 $A(x)$만 제공하는 경우가 많아,  
     “얼마나 이상한가?”는 알 수 있어도  
     “이 판단을 얼마나 믿을 수 있는가?”(불확실성)는 알기 어렵다.

2. **불확실성(uncertainty) 정보 부재**  
   - 모델이 자신 없는 영역에서 내린 이상치 판단을  
     동일한 신뢰도로 사용하게 되며,  
     이는 실제 운영 환경에서 위험한 결정으로 이어질 수 있다.

3. **비용 구조가 반영되지 않은 결정**  
   - 실제 시스템에서는  
     - 정상인데 이상치로 판단할 때의 비용(공장 정지, 서비스 중단 등)  
     - 이상치인데 정상으로 넘기는 비용(고장, 사고, 손실 등)  
     - 사람/전문가에게 “검토를 요청할 때” 드는 비용  
     이 서로 다름에도 불구하고,  
     단일 threshold 기반 이진 결정으로만 처리되는 경우가 많다.

이에 본 연구는, **딥러닝 기반 베이지안 VAE와 Mixture-of-VAEs**를 활용하여

- 다변량 데이터에서 **이상치 점수와 불확실성을 동시에 추정**하고,
- 이를 바탕으로 **STOP / CHECK / IGNORE** 형태의  
  **위험 민감(risk-aware) 의사결정 규칙**을 설계하고자 한다.

---

## 3. 연구 목표 및 연구 질문

### 3.1 연구 목표

1. **Base Model**:  
   Variational Autoencoder(VAE)를 기반으로 한 **다변량 딥러닝 이상치 탐지 모델**을 설계하여,  
   전역(global) 및 변수별(feature-wise) 이상치 점수와 불확실성을 동시에 추정한다.

2. **Extended Model**:  
   데이터가 여러 정상 모드(운영 상태)를 가진다고 가정하고,  
   **Mixture-of-VAEs (MoVAE)** 구조를 설계하여  
   모드별 이상치·불확실성과 **모드 자체에 대한 불확실성(mode uncertainty)** 를 함께 추정한다.

3. **Risk-aware Decision**:  
   이상치 점수와 불확실성 정보를 활용해  
   비용 구조를 반영한 **3-way 의사결정(STOP / CHECK / IGNORE)** 규칙을 정식화하고,  
   기존 threshold 기반 기법보다 더 낮은 위험도(risk)를 달성하는지 평가한다.

4. **범용성 검증**:  
   공정/센서 시계열, 네트워크/트래픽, 공개 multivariate anomaly dataset 등  
   서로 다른 도메인에서 제안 프레임워크의 **일관된 효과**를 검증한다.

### 3.2 연구 질문 (Research Questions)

- **RQ1.** Variational Autoencoder 기반 다변량 딥러닝 모델을 통해  
  전역 및 변수별 이상치 점수 $A(x)$와 불확실성 $U(x)$를 동시에 추정할 수 있는가?

- **RQ2.** 데이터가 여러 정상 모드를 가질 때, 단일 VAE보다  
  Mixture-of-VAEs가 이상치 탐지 및 불확실성 추정 측면에서  
  더 나은 표현력과 의사결정 성능을 제공하는가?

- **RQ3.** 추정된 $(A(x), U(x))$ (및 모드 불확실성)를 이용하여  
  STOP / CHECK / IGNORE 형태의 위험 민감 의사결정 규칙을 설계할 때,  
  기존 단일 threshold 기반 이진 의사결정보다  
  실제 비용(risk)을 유의하게 감소시킬 수 있는가?

---

## 4. 선행 연구 및 키워드 세트

### 4.1 키워드 세트

- **이상치 탐지 / 다변량**
  - multivariate anomaly detection  
  - multivariate time series anomaly detection  
  - deep anomaly detection, deep autoencoder, VAE anomaly detection  
  - reconstruction-based anomaly detection

- **딥러닝 & 베이지안 / 불확실성**
  - deep learning, representation learning (PyTorch / fastai)  
  - Bayesian deep learning, variational inference  
  - Monte Carlo Dropout, deep ensemble  
  - uncertainty quantification, aleatoric / epistemic uncertainty  
  - Variational Autoencoder, Bayesian VAE, probabilistic autoencoder  
  - mixture of VAEs, mixture density networks, mixture-of-experts

- **의사결정 / 위험**
  - selective prediction, abstention, reject option  
  - risk-aware decision making, cost-sensitive learning  
  - risk–coverage trade-off, calibration

### 4.2 선행연구 조사 계획

- **1–2개월차**에 집중적으로 논문 수집 및 정리
- 각 논문에 대해 다음 항목으로 구조화:
  - 데이터 타입 (시계열, 이미지, 센서, 트래픽 등)  
  - 딥러닝 사용 여부, VAE/flow/AE 등 모델 유형  
  - 이상치 점수 정의 방식 (reconstruction, likelihood, distance 등)  
  - 불확실성 추정 여부 및 방법  
  - risk-aware / selective decision 관점 고려 여부  
  - 본 연구와의 차별점 / 한 줄 평가

---

## 5. 연구 내용 및 방법

본 연구는 **Base Model(VAE)**와 **Extended Model(Mixture-of-VAEs)**으로 구성되며,  
두 모델에서 공통적으로 **이상치 점수 + 불확실성 추정 + risk-aware decision layer**를 설계한다.

### 5.1 Base Model: Variational Autoencoder 기반 다변량 이상치 + UQ

#### 5.1.1 확률 모형

다변량 입력 $x \in \mathbb{R}^d$에 대해, VAE 구조는 다음과 같이 정의한다.

- Prior:

$$
z \sim p(z) = \mathcal{N}(0, I)
$$

- Decoder:

$$
p_\theta(x \mid z) = \mathcal{N}\big(\mu_\theta(z), \text{diag}(\sigma^2_\theta(z))\big)
$$

- Encoder (approximate posterior):

$$
q_\phi(z \mid x) = \mathcal{N}\big(\mu_\phi(x), \text{diag}(\sigma^2_\phi(x))\big)
$$

학습은 ELBO 최적화를 통해 수행한다.

- ELBO:

$$
\mathcal{L}_{\text{ELBO}}(x;\theta,\phi) = \mathbb{E}_{q_\phi(z\mid x)}[\log p_\theta(x \mid z)] - \mathrm{KL}\big(q_\phi(z\mid x)\,\|\,p(z)\big)
$$

PyTorch/fastai로는 encoder/decoder를 MLP, 1D-CNN, LSTM 등으로 구현하고,  
출력층에서 mean 및 log-variance를 예측하도록 구성한다.

#### 5.1.2 이상치 점수 및 불확실성 정의

관측 $x$에 대해, 다음과 같이 Monte Carlo 샘플링을 수행한다.

1. $z^{(t)} \sim q_\phi(z \mid x), \quad t = 1,\dots,T$
2. $\hat x^{(t)} \sim p_\theta(x \mid z^{(t)})$

각 변수 $j = 1,\dots,d$에 대해:

- **변수별 이상치 점수 (재구성 오차)**  

$$
r_j(x) = \frac{1}{T} \sum_{t=1}^T \big(x_j - \hat x^{(t)}_j\big)^2
$$

- **변수별 불확실성 (예측 분산)**  
  평균 재구성을

$$
\bar x_j = \frac{1}{T} \sum_{t=1}^T \hat x^{(t)}_j
$$

  로 정의할 때,

$$
u_j(x) = \frac{1}{T-1} \sum_{t=1}^T \big(\hat x^{(t)}_j - \bar x_j\big)^2
$$

전역(global) 이상치 점수와 불확실성은 가중합으로 정의한다.

- 전역 이상치 점수:

$$
A_{\text{VAE}}(x) = \sum_{j=1}^d w_j r_j(x)
$$

- 전역 불확실성:

$$
U_{\text{VAE}}(x) = \sum_{j=1}^d w_j u_j(x)
$$

여기서 $w_j$는 각 변수의 중요도를 반영하는 가중치(동일 가중치 또는 도메인 지식 기반)를 의미한다.

필요 시, encoder/decoder 네트워크에 **Dropout**을 적용하여  
epistemic uncertainty를 추가로 반영할 수 있다.

---

### 5.2 Extended Model: Mixture-of-VAEs(MoVAE) 기반 다중 모드 모델

#### 5.2.1 모드(운영 상태) 가정 및 구조

다변량 데이터가 여러 정상 모드(운영 상태)를 가진다고 가정한다.  
이를 위해 $K$개의 VAE expert와 gating network로 구성된 Mixture-of-VAEs 구조를 정의한다.

- Gating network:

$$
\pi_k(x) = p_\psi(k \mid x), \quad k = 1,\dots,K
$$

  여기서 $\pi_k(x)$는 입력 $x$가 모드 $k$에 속할 확률을 나타내며,  
  $\sum_{k=1}^K \pi_k(x) = 1$을 만족한다.

- 각 expert VAE:

$$
z_k \sim p(z_k) = \mathcal{N}(0, I)
$$

$$
p_{\theta_k}(x \mid z_k) = \mathcal{N}\big(\mu_{\theta_k}(z_k), \text{diag}(\sigma^2_{\theta_k}(z_k))\big)
$$

$$
q_{\phi_k}(z_k \mid x) = \mathcal{N}\big(\mu_{\phi_k}(x), \text{diag}(\sigma^2_{\phi_k}(x))\big)
$$

- 전체 likelihood:

$$
p(x) = \sum_{k=1}^K \pi_k(x)\, p_{\theta_k}(x)
$$

학습은 mixture 형태의 ELBO 또는 EM-유사 전략,  
혹은 end-to-end joint training으로 수행할 수 있으며,  
실험 단계에서 구현 난이도와 성능을 고려하여 선택한다.

#### 5.2.2 Mixture 기반 이상치 점수

각 expert에 대해, VAE와 동일하게 재구성 기반 점수 $A_k(x)$를 정의한다.

- expert $k$의 이상치 점수(예시):

$$
A_k(x) = \sum_{j=1}^d w_j r_{j,k}(x)
$$

Mixture 전체의 이상치 점수는 다음과 같이 정의할 수 있다.

1. **likelihood 기반:**

$$
A_{\text{MoVAE}}(x) = -\log \left( \sum_{k=1}^K \pi_k(x)\, p_{\theta_k}(x) \right)
$$

2. **reconstruction 기반 가중합:**

$$
A_{\text{MoVAE}}(x) = \sum_{k=1}^K \pi_k(x)\, A_k(x)
$$

두 정의는 실험에서 비교 가능하며,  
도메인 특성에 따라 더 좋은 score 정의를 선택할 수 있다.

#### 5.2.3 불확실성: 모드 내부 + 모드 간 계층 구조

Mixture-of-VAEs에서는 불확실성이 **두 층**으로 나뉜다.

1. **expert 내부 불확실성 (in-expert uncertainty)**  
   - 각 expert $k$의 VAE에서 variance, MC 샘플 분산 등을 이용해  
     $U_k(x)$를 정의 (Base VAE와 동일 방식).

2. **모드 불확실성 (between-expert / mode uncertainty)**  
   - gating 확률 벡터 $\pi(x) = (\pi_1(x),\dots,\pi_K(x))$의 엔트로피:

$$
H_\pi(x) = -\sum_{k=1}^K \pi_k(x)\log \pi_k(x)
$$

   - $\pi_k(x)$가 한 모드에 집중되면 $H_\pi(x)$가 작고,  
     여러 모드에 고르게 분산되면 $H_\pi(x)$가 커진다.  
     → “이 샘플이 어느 모드에 속하는지 모델이 헷갈리는 정도”로 해석 가능.

3. **종합 불확실성 정의 예시**

$$
U_{\text{MoVAE}}(x) = \alpha \sum_{k=1}^K \pi_k(x)\, U_k(x) + \beta H_\pi(x)
$$

여기서 $\alpha, \beta$는 모드 내부 불확실성과 모드 불확실성의 상대적 중요도를 조절하는 하이퍼파라미터이다.

---

### 5.3 위험 민감(risk-aware) 의사결정 규칙

#### 5.3.1 의사결정 세트 및 비용 함수

각 샘플 $x$에 대하여, 세 가지 행동 중 하나를 선택한다고 가정한다.

- $\delta(x) \in \{\text{IGNORE}, \text{CHECK}, \text{STOP}\}$

실제 상태 $y \in \{\text{normal}, \text{anomaly}\}$에 대해,  
각 행동에 대한 비용을 $C(\delta(x), y)$로 정의한다.

예시:

- 정상인데 STOP → 불필요한 정지, false positive 비용  
- 이상치인데 IGNORE → 사고/고장, false negative 비용 (가장 큼)  
- CHECK → 사람/추가 검사 비용 (중간 수준)

전체 기대 위험도(risk)는 다음과 같이 정의할 수 있다.

$$
R(\delta) = \mathbb{E}_{(x,y)}\big[\,C(\delta(x), y)\,\big]
$$

실제 구현에서는 validation set 상에서의 **경험적 위험** $\hat R(\delta)$를 최소화하는 규칙을 찾는다.

#### 5.3.2 $(A(x), U(x))$ 기반 3-way decision rule

Base VAE 및 MoVAE 모두, 이상치 점수 $A(x)$와 불확실성 $U(x)$를 기반으로 다음과 같은 규칙을 정의할 수 있다.

예시 규칙:

$$
\delta(x) =
\begin{cases}
\text{STOP} & \text{if } A(x) \ge \tau_A \text{ and } U(x) \le \tau_U \\
\text{CHECK} & \text{if } A(x) \ge \tau_A \text{ and } U(x) > \tau_U \\
\text{IGNORE} & \text{if } A(x) < \tau_A
\end{cases}
$$

여기서 $(\tau_A, \tau_U)$는 validation set에서  
경험적 위험 $\hat R(\tau_A,\tau_U)$를 최소화하도록 탐색한다.

Mixture-of-VAEs의 경우,  
$U(x)$를 $U_{\text{MoVAE}}(x)$로 두거나,  
모드 엔트로피 $H_\pi(x)$를 추가 입력으로 사용하는 변형도 고려할 수 있다.

---

### 5.4 구현 계획

- **프레임워크**: PyTorch (필수), 필요 시 fastai로 학습/실험 루프 관리
- **구성 요소**
  - `models/` : VAE, Mixture-of-VAEs, gating network 모듈  
  - `datasets/` : 시계열/탭형 multivariate anomaly dataset 로더  
  - `training/` : 학습 루프, ELBO 계산, threshold search, risk 계산  
  - `analysis/` : ROC, PR, risk–coverage, 의사결정 시뮬레이션, 시각화

---

## 6. 실험 계획

### 6.1 데이터셋 (예시 방향)

- **Synthetic multivariate 데이터**
  - 다변량 Gaussian, mixture, non-linear manifold 데이터 생성  
  - 단일 모드 vs 다중 모드 환경에서 VAE와 MoVAE 비교

- **공개 multivariate anomaly dataset**
  - 예: 서버/센서/시계열 관련 공개 데이터셋 (SMD, MSL, SWaT 등)  
  - 도메인에 따라 tabular/multivariate time series 데이터 추가 검토

### 6.2 비교 방법 및 지표

- **Baseline 모델**
  - 단순 Autoencoder 기반 이상치 탐지  
  - VAE (불확실성 고려하지 않는 score-only 버전)  
  - 필요시 다른 딥러닝 기반 anomaly detection 방법

- **성능 지표**
  - 이상치 탐지:
    - AUROC, AUPR, F1-score, FPR@95TPR 등
  - 의사결정 / risk 관점:
    - risk–coverage curve  
    - false alarm 수, missed anomaly 수  
    - CHECK(사람 검토) 비율 대비 risk 감소 정도

---

## 7. 연구 일정 (12개월 기준 예시)

1. **1–2개월차: 문헌 조사 및 문제 정의**
   - 키워드 기반 선행 연구 수집 및 정리  
   - 관련 연구 요약 및 연구 질문(RQ) 확정

2. **3–4개월차: 수식 정식화 및 모델 설계**
   - VAE / Mixture-of-VAEs 수식 정리 및 손실 함수 정의  
   - 이상치 점수, 불확실성, decision rule 공식화  
   - 간단한 이론적 성질(정의, lemma, risk–coverage 개념) 초안 작성

3. **5–7개월차: PyTorch 구현 및 초기 실험**
   - Base VAE 및 MoVAE 구현  
   - synthetic 데이터 및 1개 공개 데이터셋에서 1차 검증  
   - 코드 구조 안정화 및 hyperparameter 기본 설정

4. **8–9개월차: 본 실험 및 분석**
   - 추가 데이터셋에 대한 본격 실험  
   - Single VAE vs Mixture-of-VAEs 비교  
   - risk-aware decision 관점에서의 성능 분석 및 ablation study

5. **10–11개월차: 논문 집필**
   - 방법론(3–4장), 실험(5장)부터 집필  
   - 서론·관련연구(1–2장), 결론(6장) 작성 및 통합  
   - 지도교수 피드백 반영 및 수정

6. **12개월차: 최종 정리 및 제출**
   - 논문 형식, 참고문헌, 그림/표 정리  
   - 발표 자료 준비 및 최종 점검

---

## 8. 기대 효과 및 기여

1. **모델링 기여**  
   - 다변량 데이터를 위한 **딥러닝 기반 Bayesian VAE + Mixture-of-VAEs** 구조를 설계하여,  
     전역 및 변수별 이상치 점수와 **계층적 불확실성(internal + mode uncertainty)**을 동시에 제공한다.

2. **의사결정 기여**  
   - 이상치 점수와 불확실성을 활용한 **risk-aware 3-way 의사결정(STOP / CHECK / IGNORE)** 규칙을 제안하고,  
     비용 구조를 반영한 위험도 관점에서 기존 방법보다 더 나은 성능을 보임을 보인다.

3. **범용성 기여**  
   - 공정/센서, 네트워크/트래픽, 일반 multivariate dataset 등  
     서로 다른 도메인에 동일 프레임워크를 적용함으로써,  
     **범용적인 “이상치 + 불확실성 + 의사결정” 프레임워크**로서의 가능성을 제시한다.

4. **실무 적용 가능성**  
   - 실제 시스템에서  
     - 언제 자동으로 STOP할지,  
     - 언제 사람에게 CHECK를 요청할지,  
     - 언제 IGNORE해도 되는지  
     를 정량적으로 판단하는 기준을 제공하여,  
     신뢰 가능한 이상치 탐지 기반 의사결정 시스템 설계에 기여할 수 있다.
